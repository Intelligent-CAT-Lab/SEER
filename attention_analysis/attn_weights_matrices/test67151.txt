67151
Test: public void testSimpleArrayRecovery() throws Exception { final String JSON = aposToQuotes("[{'a':3},{'a':27,'foo':[1,2],'b':{'x':3}} ,{'a':1,'b':2} ]"); MappingIterator<Bean> it = MAPPER.readerFor(Bean.class).readValues(JSON); Bean bean = it.nextValue(); try { it.nextValue(); } catch (JsonMappingException e) { verifyException(e, "Unrecognized field \"foo\""); } bean = it.nextValue(); it.close(); }
Code: public T nextValue() throws IOException { switch (_state) { case STATE_CLOSED: return _throwNoSuchElement(); case STATE_NEED_RESYNC: case STATE_MAY_HAVE_VALUE: if (!hasNextValue()) { return _throwNoSuchElement(); } break; case STATE_HAS_VALUE: break; } int nextState = STATE_NEED_RESYNC; try { T value; if (_updatedValue == null) { value = _deserializer.deserialize(_parser, _context); } else{ _deserializer.deserialize(_parser, _context, _updatedValue); value = _updatedValue; } nextState = STATE_MAY_HAVE_VALUE; return value; } finally { _state = nextState; _parser.clearCurrentToken(); } }
tensor([[0.0103, 0.0067, 0.0085,  ..., 0.0150, 0.0043, 0.0043],
        [0.0094, 0.0054, 0.0064,  ..., 0.0186, 0.0041, 0.0041],
        [0.0105, 0.0055, 0.0056,  ..., 0.0168, 0.0036, 0.0036],
        ...,
        [0.0098, 0.0060, 0.0079,  ..., 0.0160, 0.0044, 0.0044],
        [0.0076, 0.0051, 0.0068,  ..., 0.0190, 0.0035, 0.0035],
        [0.0076, 0.0051, 0.0068,  ..., 0.0190, 0.0035, 0.0035]])