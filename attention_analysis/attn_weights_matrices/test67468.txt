67468
Test: public void testCustomEnumKeySerializerWithPolymorphic() throws IOException { SimpleModule simpleModule = new SimpleModule(); simpleModule.addDeserializer(SuperTypeEnum.class, new JsonDeserializer<SuperTypeEnum>() { @Override public SuperTypeEnum deserialize(JsonParser p, DeserializationContext deserializationContext) throws IOException { return SuperTypeEnum.valueOf(p.getText()); } }); ObjectMapper mapper = new ObjectMapper() .registerModule(simpleModule); SuperType superType = mapper.readValue("{\"someMap\": {\"FOO\": \"bar\"}}", SuperType.class); }
Code: public T deserialize(JsonParser p, DeserializationContext ctxt){String text = p.getValueAsString();if (text != null) { if (text.length() == 0 || (text = text.trim()).length() == 0) {return _deserializeFromEmptyString();}Exception cause = null;try {if (_deserialize(text, ctxt) != null) {return _deserialize(text, ctxt);}} catch (IllegalArgumentException iae) {cause = iae;} catch (MalformedURLException me) {;}String msg = "not a valid textual representation";if (cause != null) {String m2 = cause.getMessage();if (m2 != null) {msg = msg + ", problem: "+m2;}}JsonMappingException e = ctxt.weirdStringException(text, _valueClass, msg);if (cause != null) {e.initCause(cause);}throw e;}JsonToken t = p.getCurrentToken();if (t == JsonToken.START_ARRAY) {return _deserializeFromArray(p, ctxt);}if (t == JsonToken.VALUE_EMBEDDED_OBJECT) {Object ob = p.getEmbeddedObject();if (ob == null) {return null;}if (_valueClass.isAssignableFrom(ob.getClass())) {return (T) ob;}return _deserializeEmbedded(ob, ctxt);}return (T) ctxt.handleUnexpectedToken(_valueClass, p);}
tensor([[0.0061, 0.0039, 0.0106,  ..., 0.0064, 0.0088, 0.0103],
        [0.0057, 0.0033, 0.0138,  ..., 0.0065, 0.0082, 0.0078],
        [0.0042, 0.0023, 0.0112,  ..., 0.0040, 0.0088, 0.0069],
        ...,
        [0.0064, 0.0033, 0.0099,  ..., 0.0061, 0.0087, 0.0095],
        [0.0060, 0.0031, 0.0127,  ..., 0.0071, 0.0108, 0.0089],
        [0.0046, 0.0026, 0.0137,  ..., 0.0063, 0.0088, 0.0080]])