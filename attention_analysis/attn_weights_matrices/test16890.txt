16890
Test: public void testSheqRefinedScope() throws Exception { Node n = parseAndTypeCheck( "function A() {}\n" + " function B() {}\n" + "\n" + "B.prototype.p = function() { return 1; }\n" + "\n" + "function f(a, b) {\n" + " b.p();\n" + " if (a === b) {\n" + " b.p();\n" + " }\n" + "}"); Node nodeC = n.getLastChild().getLastChild().getLastChild().getLastChild() .getLastChild().getLastChild(); JSType typeC = nodeC.getJSType(); Node nodeB = nodeC.getFirstChild().getFirstChild(); JSType typeB = nodeB.getJSType(); }
Code: private JSType getJSType(Node n) { JSType jsType = n.getJSType(); if (jsType == null) { return compiler.getTypeRegistry().getNativeType( JSTypeNative.UNKNOWN_TYPE); } else { return jsType; } }
[[0.04523469 0.06873368 0.03245227 0.04154798 0.05376646 0.06873368
 0.06275959 0.01815861 0.06299084 0.09707896 0.05396505 0.03656866
 0.0165419  0.05376646 0.03111978 0.01915605 0.03703705 0.01427022
 0.04414406 0.05376646 0.03111978 0.02854729 0.01427022 0.01427022]
[0.0464745  0.08315096 0.02659978 0.03761174 0.05038653 0.08315096
 0.07144402 0.02093735 0.06466725 0.08343287 0.05409998 0.03787071
 0.01576422 0.05038653 0.03399185 0.01591813 0.03779175 0.01133457
 0.04178562 0.05038653 0.03399185 0.02615311 0.01133457 0.01133457]
[0.03724551 0.0917582  0.03195235 0.04122696 0.04696172 0.0917582
 0.07850404 0.01652721 0.05731557 0.09391674 0.04576411 0.03770033
 0.01172343 0.04696172 0.03469452 0.01429558 0.03619532 0.01205886
 0.0388271  0.04696172 0.03469452 0.02883856 0.01205886 0.01205886]
[0.03232509 0.08953085 0.02975238 0.03800157 0.04769966 0.08953085
 0.07082187 0.01831777 0.06359056 0.07746996 0.05222627 0.04042219
 0.01533416 0.04769966 0.03347049 0.01833546 0.04574769 0.0159156
 0.0346889  0.04769966 0.03347049 0.02611767 0.0159156  0.0159156 ]
[0.04141375 0.0486512  0.03568626 0.03806213 0.05534625 0.0486512
 0.06249326 0.02849396 0.05795052 0.05887033 0.06092262 0.03652258
 0.02205389 0.05534625 0.03932325 0.01836159 0.04458665 0.01945946
 0.05530502 0.05534625 0.03932325 0.0389114  0.01945946 0.01945946]
[0.0464745  0.08315096 0.02659978 0.03761174 0.05038653 0.08315096
 0.07144402 0.02093735 0.06466725 0.08343287 0.05409998 0.03787071
 0.01576422 0.05038653 0.03399185 0.01591813 0.03779175 0.01133457
 0.04178562 0.05038653 0.03399185 0.02615311 0.01133457 0.01133457]
[0.04253647 0.07711992 0.02357424 0.03605798 0.05777119 0.07711992
 0.08864579 0.01735191 0.05672479 0.09182362 0.05072568 0.03563411
 0.01213613 0.05777119 0.03326536 0.01645733 0.02906181 0.01145994
 0.04325053 0.05777119 0.03326536 0.02755566 0.01145994 0.01145994]
[0.04583759 0.05474826 0.03797339 0.04636652 0.04237517 0.05474826
 0.05080453 0.03076946 0.04410861 0.0817145  0.05170507 0.0413924
 0.02336404 0.04237517 0.04058924 0.02868937 0.04405749 0.01824229
 0.04493316 0.04237517 0.04058924 0.05575646 0.01824229 0.01824229]
[0.03676036 0.07748721 0.02151129 0.03600927 0.05352162 0.07748721
 0.08144193 0.01622591 0.0716077  0.09510057 0.06971013 0.03053305
 0.01001496 0.05352162 0.03215691 0.01565553 0.03255606 0.00991236
 0.04514235 0.05352162 0.03215691 0.02814069 0.00991236 0.00991236]
[0.0449213  0.10943209 0.02489699 0.03281611 0.04862677 0.10943209
 0.07675996 0.01516174 0.04875983 0.10671711 0.04815789 0.03362805
 0.00679461 0.04862677 0.0246745  0.01337575 0.03589379 0.00703985
 0.05533416 0.04862677 0.0246745  0.02156967 0.00703985 0.00703985]
[0.03373216 0.06774389 0.02548147 0.04301741 0.04218233 0.06774389
 0.06743132 0.02029363 0.05326229 0.09658267 0.06299557 0.04318941
 0.01526731 0.04218233 0.03174934 0.02253725 0.04677898 0.01504099
 0.05043007 0.04218233 0.03174934 0.04834407 0.01504099 0.01504099]
[0.03977102 0.08687294 0.02458297 0.03552812 0.0524847  0.08687294
 0.08992226 0.01826564 0.06248204 0.09325472 0.05193836 0.04071291
 0.01095909 0.0524847  0.0286858  0.01243223 0.03433615 0.01036138
 0.03970557 0.0524847  0.0286858  0.02645327 0.01036138 0.01036138]
[0.03171786 0.08391738 0.02314836 0.03649241 0.05662747 0.08391738
 0.07904966 0.01519633 0.05603281 0.10303636 0.04762466 0.04181774
 0.01368352 0.05662747 0.02807925 0.01847921 0.04113482 0.00845022
 0.03688789 0.05662747 0.02807925 0.03647199 0.00845022 0.00845022]
[0.04141375 0.0486512  0.03568626 0.03806213 0.05534625 0.0486512
 0.06249326 0.02849396 0.05795052 0.05887033 0.06092262 0.03652258
 0.02205389 0.05534625 0.03932325 0.01836159 0.04458665 0.01945946
 0.05530502 0.05534625 0.03932325 0.0389114  0.01945946 0.01945946]
[0.04264539 0.08004498 0.02808002 0.04196408 0.04492242 0.08004498
 0.08694085 0.0202965  0.06097674 0.08116709 0.05573826 0.03639391
 0.01162463 0.04492242 0.02884646 0.01710137 0.03614359 0.0120604
 0.05387064 0.04492242 0.02884646 0.0383256  0.0120604  0.0120604 ]
[0.03138894 0.08600973 0.02386163 0.03695282 0.05316821 0.08600973
 0.08058318 0.01723038 0.05137497 0.08133648 0.06235983 0.04109574
 0.01182061 0.05316821 0.03384981 0.01733283 0.03820196 0.01101613
 0.04473431 0.05316821 0.03384981 0.02945415 0.01101613 0.01101613]
[0.03837474 0.06671863 0.02456972 0.04077829 0.05036969 0.06671863
 0.08860491 0.01758387 0.05079587 0.0897272  0.05717079 0.03731369
 0.01426716 0.05036969 0.04274116 0.01633354 0.03642878 0.01130414
 0.04782342 0.05036969 0.04274116 0.03628698 0.01130414 0.01130414]
[0.03396725 0.07064891 0.02639084 0.03641481 0.05753738 0.07064891
 0.0662915  0.01947885 0.05718164 0.08236398 0.0529395  0.03694216
 0.0131612  0.05753738 0.04713115 0.01684083 0.03790601 0.01222994
 0.04873491 0.05753738 0.04713115 0.02652448 0.01222994 0.01222994]
[0.03495637 0.07968614 0.02495064 0.03623167 0.05167414 0.07968614
 0.10040423 0.01753627 0.06176437 0.07799357 0.05134302 0.03705344
 0.01219614 0.05167414 0.03348718 0.01465504 0.03572005 0.01046829
 0.04500918 0.05167414 0.03348718 0.03741211 0.01046829 0.01046829]
[0.04141375 0.0486512  0.03568626 0.03806213 0.05534625 0.0486512
 0.06249326 0.02849396 0.05795052 0.05887033 0.06092262 0.03652258
 0.02205389 0.05534625 0.03932325 0.01836159 0.04458665 0.01945946
 0.05530502 0.05534625 0.03932325 0.0389114  0.01945946 0.01945946]
[0.04264539 0.08004498 0.02808002 0.04196408 0.04492242 0.08004498
 0.08694085 0.0202965  0.06097674 0.08116709 0.05573826 0.03639391
 0.01162463 0.04492242 0.02884646 0.01710137 0.03614359 0.0120604
 0.05387064 0.04492242 0.02884646 0.0383256  0.0120604  0.0120604 ]
[0.03558432 0.09384485 0.02765109 0.03174988 0.05781306 0.09384485
 0.07006592 0.01486761 0.0499864  0.08200537 0.05658327 0.03403831
 0.01348229 0.05781306 0.03158848 0.01800093 0.03694812 0.01351632
 0.04208224 0.05781306 0.03158848 0.02209941 0.01351632 0.01351632]
[0.03396725 0.07064891 0.02639084 0.03641481 0.05753738 0.07064891
 0.0662915  0.01947885 0.05718164 0.08236398 0.0529395  0.03694216
 0.0131612  0.05753738 0.04713115 0.01684083 0.03790601 0.01222994
 0.04873491 0.05753738 0.04713115 0.02652448 0.01222994 0.01222994]
[0.03396725 0.07064891 0.02639084 0.03641481 0.05753738 0.07064891
 0.0662915  0.01947885 0.05718164 0.08236398 0.0529395  0.03694216
 0.0131612  0.05753738 0.04713115 0.01684083 0.03790601 0.01222994
 0.04873491 0.05753738 0.04713115 0.02652448 0.01222994 0.01222994]]