66563
Test: public void testSimpleNumbers() throws Exception { final StringBuilder sb = new StringBuilder(); MAPPER.acceptJsonFormatVisitor(Numbers.class, new JsonFormatVisitorWrapper.Base() { @Override public JsonObjectFormatVisitor expectObjectFormat(final JavaType type) { return new JsonObjectFormatVisitor.Base(getProvider()) { @Override public void optionalProperty(BeanProperty prop) throws JsonMappingException { sb.append("[optProp ").append(prop.getName()).append("("); JsonSerializer<Object> ser = null; if (prop instanceof BeanPropertyWriter) { BeanPropertyWriter bpw = (BeanPropertyWriter) prop; ser = bpw.getSerializer(); } final SerializerProvider prov = getProvider(); if (ser == null) { ser = prov.findValueSerializer(prop.getType(), prop); } ser.acceptJsonFormatVisitor(new JsonFormatVisitorWrapper.Base() { @Override public JsonNumberFormatVisitor expectNumberFormat( JavaType type) throws JsonMappingException { return new JsonNumberFormatVisitor() { @Override public void format(JsonValueFormat format) { sb.append("[numberFormat=").append(format).append("]"); } @Override public void enumTypes(Set<String> enums) { } @Override public void numberType(NumberType numberType) { sb.append("[numberType=").append(numberType).append("]"); } }; } @Override public JsonIntegerFormatVisitor expectIntegerFormat(JavaType type) throws JsonMappingException { return new JsonIntegerFormatVisitor() { @Override public void format(JsonValueFormat format) { sb.append("[integerFormat=").append(format).append("]"); } @Override public void enumTypes(Set<String> enums) { } @Override public void numberType(NumberType numberType) { sb.append("[numberType=").append(numberType).append("]"); } }; } }, prop.getType()); sb.append(")]"); } }; } }); }
Code: public void acceptJsonFormatVisitor(JsonFormatVisitorWrapper visitor, JavaType typeHint) throws JsonMappingException { if (_isInt) { visitIntFormat(visitor, typeHint, JsonParser.NumberType.BIG_INTEGER); } else { Class<?> h = handledType(); if (h == BigDecimal.class) { visitFloatFormat(visitor, typeHint, JsonParser.NumberType.BIG_INTEGER); } else { visitor.expectNumberFormat(typeHint); } } }
[[0.02144491 0.01716458 0.02327858 0.02966425 0.03595706 0.04125325
 0.05187165 0.03291387 0.02714022 0.05765564 0.02469588 0.02714022
 0.00944059 0.03589521 0.02366038 0.00881889 0.03209905 0.02714022
 0.01081885 0.04945808 0.01340079 0.04341503 0.05765564 0.02379139
 0.0342402  0.0198025  0.02714022 0.02316284 0.03589521 0.02366038
 0.00881889 0.03209905 0.02714021 0.01580962 0.00881889 0.00881889
 0.00881889]
[0.01749086 0.01410551 0.02251293 0.02426772 0.04371275 0.04891276
 0.06409519 0.0310842  0.02515758 0.05736596 0.02284028 0.02515758
 0.00601678 0.04232167 0.01863279 0.00787528 0.04064374 0.02515758
 0.00605666 0.04957323 0.01334684 0.05141652 0.05736596 0.02051653
 0.02613721 0.01967146 0.02515758 0.02330173 0.04232167 0.01863279
 0.00787528 0.04064374 0.02515757 0.01184833 0.00787529 0.00787529
 0.00787528]
[0.01626336 0.01362235 0.02578901 0.02832434 0.03514094 0.04077918
 0.06156413 0.02353838 0.0275505  0.06382368 0.01787538 0.0275505
 0.00832077 0.04416555 0.02194301 0.0059928  0.03257101 0.0275505
 0.00954074 0.05260834 0.01276382 0.04876958 0.06382368 0.02203945
 0.02902737 0.02526209 0.0275505  0.0230607  0.04416555 0.02194301
 0.0059928  0.03257101 0.02755051 0.01298714 0.0059928  0.0059928
 0.0059928 ]
[0.02069458 0.01541089 0.01992223 0.02959437 0.03873847 0.04749155
 0.04918562 0.02648517 0.03033779 0.05111916 0.022231   0.03033779
 0.00940679 0.03885864 0.01764863 0.00660482 0.04136064 0.03033779
 0.00964248 0.04870148 0.01173    0.04639463 0.05111916 0.02335243
 0.03303242 0.02239392 0.03033779 0.02735482 0.03885864 0.01764863
 0.00660482 0.04136064 0.03033778 0.01554997 0.00660482 0.00660482
 0.00660482]
[0.02121931 0.01147858 0.01892413 0.0269434  0.03873501 0.04639166
 0.05881497 0.02340428 0.03002234 0.0710388  0.02177945 0.03002234
 0.00917842 0.03642808 0.01783367 0.00738068 0.03132692 0.03002234
 0.00755179 0.03837315 0.01229991 0.05839106 0.0710388  0.0191218
 0.03305668 0.02108974 0.03002234 0.0193677  0.03642808 0.01783367
 0.00738068 0.03132692 0.03002233 0.01360892 0.00738068 0.00738068
 0.00738068]
[0.01905443 0.0156809  0.02264817 0.02722818 0.03805613 0.03631566
 0.06728522 0.02386973 0.02585633 0.05284968 0.02175035 0.02585633
 0.00809193 0.04086458 0.02183482 0.00823548 0.03937175 0.02585633
 0.00778777 0.05247688 0.01474621 0.04901441 0.05284968 0.02440844
 0.03095802 0.02243991 0.02585633 0.02232648 0.04086458 0.02183482
 0.00823548 0.03937175 0.02585634 0.01556033 0.00823548 0.00823548
 0.00823548]
[0.01467097 0.01337076 0.02433161 0.02811993 0.0390173  0.04937335
 0.07720704 0.02578161 0.02980751 0.06546361 0.01947044 0.02980751
 0.00621543 0.0344866  0.01620559 0.00618258 0.04606187 0.02980751
 0.00655426 0.04070553 0.01261386 0.04922419 0.06546361 0.01730496
 0.02399575 0.01703937 0.02980751 0.01819496 0.0344866  0.01620559
 0.00618258 0.04606187 0.02980752 0.01242287 0.00618258 0.00618258
 0.00618258]
[0.01545451 0.01504108 0.02850121 0.03380525 0.04001918 0.04906805
 0.0588196  0.02521996 0.03135262 0.05775738 0.02504051 0.03135262
 0.00719351 0.03502121 0.01571959 0.00838499 0.04095137 0.03135262
 0.00665832 0.03887494 0.01581026 0.04576755 0.05775738 0.01732576
 0.02893442 0.01825686 0.03135262 0.01917683 0.03502121 0.01571959
 0.00838499 0.04095137 0.03135264 0.01344506 0.00838499 0.00838499
 0.00838499]
[0.02274967 0.01945669 0.0169512  0.03354684 0.03848886 0.04982267
 0.04121035 0.02566582 0.03205901 0.0397759  0.02128272 0.03205901
 0.01150839 0.03495317 0.01950353 0.01202463 0.041433   0.03205901
 0.01033411 0.04236311 0.01873473 0.04521413 0.0397759  0.02094497
 0.02538366 0.02134198 0.03205901 0.02440098 0.03495317 0.01950353
 0.01202463 0.041433   0.03205901 0.01884974 0.01202462 0.01202462
 0.01202463]
[0.01328306 0.0093418  0.02872464 0.01967185 0.03727878 0.03598458
 0.07955471 0.02049036 0.02252155 0.07287618 0.01547797 0.02252155
 0.00333805 0.05138731 0.01492163 0.0036651  0.06448909 0.02252155
 0.00544143 0.05400582 0.00993011 0.03747816 0.07287618 0.01940282
 0.02920436 0.01852649 0.02252155 0.01624072 0.05138731 0.01492163
 0.0036651  0.06448909 0.02252155 0.00834259 0.0036651  0.0036651
 0.0036651 ]
[0.01690489 0.01285319 0.02546308 0.02597702 0.03834877 0.04492529
 0.06545778 0.02368326 0.02387759 0.06395762 0.021607   0.02387759
 0.00552941 0.04288349 0.01286588 0.0059708  0.04969165 0.02387759
 0.00748668 0.05361818 0.01384897 0.0476936  0.06395762 0.01893717
 0.03783574 0.02112542 0.02387759 0.01736096 0.04288349 0.01286588
 0.0059708  0.04969165 0.0238776  0.01330436 0.0059708  0.0059708
 0.0059708 ]
[0.02274967 0.01945669 0.0169512  0.03354684 0.03848886 0.04982267
 0.04121035 0.02566582 0.03205901 0.0397759  0.02128272 0.03205901
 0.01150839 0.03495317 0.01950353 0.01202463 0.041433   0.03205901
 0.01033411 0.04236311 0.01873473 0.04521413 0.0397759  0.02094497
 0.02538366 0.02134198 0.03205901 0.02440098 0.03495317 0.01950353
 0.01202463 0.041433   0.03205901 0.01884974 0.01202462 0.01202462
 0.01202463]
[0.01755069 0.01933904 0.02717296 0.02582034 0.03926029 0.05615785
 0.06147567 0.0268505  0.03122687 0.04561882 0.02142541 0.03122687
 0.00802864 0.03565276 0.01910583 0.00638738 0.04869853 0.03122687
 0.00808053 0.03922198 0.01572173 0.03910518 0.04561882 0.02212747
 0.03154423 0.02095064 0.03122687 0.01877955 0.03565276 0.01910583
 0.00638738 0.04869853 0.03122686 0.01516419 0.00638738 0.00638738
 0.00638738]
[0.01850904 0.01252543 0.02578312 0.03433463 0.03667958 0.05521831
 0.05657969 0.02360688 0.02300557 0.06350452 0.02083573 0.02300557
 0.00701448 0.04460036 0.01999525 0.00744249 0.03765644 0.02300557
 0.00846937 0.04536754 0.01358961 0.04866318 0.06350452 0.02486072
 0.02830794 0.01897187 0.02300557 0.02030719 0.04460036 0.01999525
 0.00744249 0.03765644 0.02300557 0.01662227 0.00744249 0.00744249
 0.00744249]
[0.01993434 0.01722046 0.02542764 0.02408234 0.04079878 0.04237331
 0.0614244  0.02270994 0.02209358 0.05702238 0.02294668 0.02209358
 0.00846202 0.04476989 0.02223174 0.00765175 0.039039   0.02209358
 0.00940166 0.04470374 0.01558128 0.048748   0.05702238 0.02481147
 0.02711187 0.02504353 0.02209358 0.02652317 0.04476989 0.02223174
 0.00765175 0.039039   0.02209358 0.01784271 0.00765175 0.00765175
 0.00765175]
[0.01539819 0.01352388 0.01593301 0.02904391 0.03422067 0.03939955
 0.06542805 0.03004807 0.03191891 0.05774611 0.02635376 0.03191891
 0.00824604 0.0381464  0.02186537 0.00723767 0.04074437 0.03191891
 0.00796814 0.04813288 0.01309257 0.0362916  0.05774611 0.02434302
 0.02603322 0.01794729 0.03191891 0.02234878 0.0381464  0.02186537
 0.00723767 0.04074437 0.03191891 0.01346003 0.00723767 0.00723767
 0.00723767]
[0.01736901 0.01267466 0.02316659 0.02908817 0.0423804  0.05173316
 0.06003068 0.02894892 0.02817602 0.0543588  0.02105265 0.02817602
 0.00744364 0.03202711 0.02092233 0.00619899 0.04123321 0.02817602
 0.0091931  0.05203244 0.0125357  0.05122557 0.0543588  0.02082193
 0.02871055 0.02697433 0.02817602 0.02185594 0.03202711 0.02092233
 0.00619899 0.04123321 0.02817602 0.01380463 0.00619899 0.00619899
 0.00619899]
[0.02274967 0.01945669 0.0169512  0.03354684 0.03848886 0.04982267
 0.04121035 0.02566582 0.03205901 0.0397759  0.02128272 0.03205901
 0.01150839 0.03495317 0.01950353 0.01202463 0.041433   0.03205901
 0.01033411 0.04236311 0.01873473 0.04521413 0.0397759  0.02094497
 0.02538366 0.02134198 0.03205901 0.02440098 0.03495317 0.01950353
 0.01202463 0.041433   0.03205901 0.01884974 0.01202462 0.01202462
 0.01202463]
[0.01612236 0.01568246 0.03066478 0.02673548 0.04303463 0.05014357
 0.05883358 0.02530795 0.02605255 0.05139015 0.02405294 0.02605255
 0.00939262 0.0412005  0.01777282 0.00800067 0.03936993 0.02605255
 0.00752103 0.04377608 0.01719641 0.04620054 0.05139015 0.02271985
 0.03409553 0.02380404 0.02605255 0.01919819 0.0412005  0.01777282
 0.00800067 0.03936993 0.02605256 0.01578501 0.00800067 0.00800067
 0.00800067]
[0.023299   0.02056746 0.02350782 0.03777841 0.03903646 0.04540843
 0.04196599 0.02615504 0.02589998 0.05137804 0.02214908 0.02589998
 0.01231374 0.03497362 0.02352634 0.01379608 0.02965667 0.02589998
 0.01315553 0.03581387 0.01618521 0.04485853 0.05137804 0.01932605
 0.03627298 0.02159097 0.02589998 0.0251154  0.03497362 0.02352634
 0.01379608 0.02965667 0.02589998 0.01795046 0.01379608 0.01379608
 0.01379608]
[0.02511465 0.02002653 0.01515029 0.02849723 0.03368218 0.03548337
 0.03772517 0.02955046 0.02611659 0.05514856 0.02388747 0.02611659
 0.01326026 0.03333183 0.0229704  0.01176674 0.03247356 0.02611659
 0.01453269 0.05005664 0.02017553 0.05454751 0.05514856 0.01679407
 0.02892745 0.02680304 0.02611659 0.02610916 0.03333183 0.0229704
 0.01176674 0.03247356 0.02611659 0.02241088 0.01176674 0.01176674
 0.01176674]
[0.02214839 0.01619053 0.02229538 0.03032897 0.03698517 0.05064303
 0.059607   0.02371181 0.0295206  0.05552501 0.02030958 0.0295206
 0.00774279 0.04002085 0.01944023 0.00964585 0.04238932 0.0295206
 0.00801779 0.03425041 0.01233026 0.04523806 0.05552501 0.02102878
 0.02653868 0.01755089 0.0295206  0.02144177 0.04002085 0.01944023
 0.00964585 0.04238932 0.0295206  0.01305772 0.00964585 0.00964585
 0.00964585]
[0.01328306 0.0093418  0.02872464 0.01967185 0.03727878 0.03598458
 0.07955471 0.02049036 0.02252155 0.07287618 0.01547797 0.02252155
 0.00333805 0.05138731 0.01492163 0.0036651  0.06448909 0.02252155
 0.00544143 0.05400582 0.00993011 0.03747816 0.07287618 0.01940282
 0.02920436 0.01852649 0.02252155 0.01624072 0.05138731 0.01492163
 0.0036651  0.06448909 0.02252155 0.00834259 0.0036651  0.0036651
 0.0036651 ]
[0.01946107 0.01660826 0.01853076 0.02888783 0.02761412 0.04232021
 0.059742   0.02296456 0.02820201 0.08720309 0.02301022 0.02820201
 0.00627326 0.03126187 0.02187105 0.0057097  0.03433432 0.02820201
 0.00993257 0.0394146  0.01279864 0.04733344 0.08720309 0.01947698
 0.0288135  0.01858459 0.02820201 0.02281861 0.03126187 0.02187105
 0.0057097  0.03433432 0.02820202 0.0165155  0.0057097  0.0057097
 0.0057097 ]
[0.0122361  0.0114064  0.02896329 0.02795827 0.04055272 0.05556707
 0.05953832 0.02563738 0.02423164 0.06821263 0.01866311 0.02423164
 0.00475454 0.05641645 0.01273873 0.00530668 0.04136404 0.02423164
 0.00455582 0.04634286 0.01219926 0.04943695 0.06821263 0.02046608
 0.03165134 0.01883395 0.02423164 0.01552752 0.05641645 0.01273873
 0.00530668 0.04136404 0.02423165 0.01055366 0.00530669 0.00530669
 0.00530669]
[0.01981577 0.0146057  0.02192751 0.02933804 0.04281693 0.0452267
 0.06146391 0.02386899 0.02752137 0.06456537 0.02388491 0.02752137
 0.00844844 0.03546737 0.01889541 0.0087391  0.03963232 0.02752137
 0.0075708  0.04351045 0.01321085 0.04783812 0.06456537 0.01826518
 0.02565068 0.01676102 0.02752137 0.02375331 0.03546737 0.01889541
 0.0087391  0.03963232 0.02752136 0.0136194  0.0087391  0.0087391
 0.0087391 ]
[0.02274967 0.01945669 0.0169512  0.03354684 0.03848886 0.04982267
 0.04121035 0.02566582 0.03205901 0.0397759  0.02128272 0.03205901
 0.01150839 0.03495317 0.01950353 0.01202463 0.041433   0.03205901
 0.01033411 0.04236311 0.01873473 0.04521413 0.0397759  0.02094497
 0.02538366 0.02134198 0.03205901 0.02440098 0.03495317 0.01950353
 0.01202463 0.041433   0.03205901 0.01884974 0.01202462 0.01202462
 0.01202463]
[0.02165609 0.01563069 0.02463768 0.02692533 0.03644789 0.04798739
 0.05835589 0.02474608 0.02814281 0.05580803 0.02130635 0.02814281
 0.00874681 0.03635492 0.02344766 0.00773722 0.04412839 0.02814281
 0.00941833 0.04218316 0.01358747 0.03516629 0.05580803 0.02514274
 0.02541881 0.02086566 0.02814281 0.0246519  0.03635492 0.02344766
 0.00773722 0.04412839 0.0281428  0.01824738 0.00773721 0.00773721
 0.00773721]
[0.01850904 0.01252543 0.02578312 0.03433463 0.03667958 0.05521831
 0.05657969 0.02360688 0.02300557 0.06350452 0.02083573 0.02300557
 0.00701448 0.04460036 0.01999525 0.00744249 0.03765644 0.02300557
 0.00846937 0.04536754 0.01358961 0.04866318 0.06350452 0.02486072
 0.02830794 0.01897187 0.02300557 0.02030719 0.04460036 0.01999525
 0.00744249 0.03765644 0.02300557 0.01662227 0.00744249 0.00744249
 0.00744249]
[0.01993434 0.01722046 0.02542764 0.02408234 0.04079878 0.04237331
 0.0614244  0.02270994 0.02209358 0.05702238 0.02294668 0.02209358
 0.00846202 0.04476989 0.02223174 0.00765175 0.039039   0.02209358
 0.00940166 0.04470374 0.01558128 0.048748   0.05702238 0.02481147
 0.02711187 0.02504353 0.02209358 0.02652317 0.04476989 0.02223174
 0.00765175 0.039039   0.02209358 0.01784271 0.00765175 0.00765175
 0.00765175]
[0.01539819 0.01352388 0.01593301 0.02904391 0.03422067 0.03939955
 0.06542805 0.03004807 0.03191891 0.05774611 0.02635376 0.03191891
 0.00824604 0.0381464  0.02186537 0.00723767 0.04074437 0.03191891
 0.00796814 0.04813288 0.01309257 0.0362916  0.05774611 0.02434302
 0.02603322 0.01794729 0.03191891 0.02234878 0.0381464  0.02186537
 0.00723767 0.04074437 0.03191891 0.01346003 0.00723767 0.00723767
 0.00723767]
[0.01736901 0.01267466 0.02316659 0.02908817 0.0423804  0.05173316
 0.06003068 0.02894892 0.02817602 0.0543588  0.02105265 0.02817602
 0.00744364 0.03202711 0.02092233 0.00619899 0.04123321 0.02817602
 0.0091931  0.05203244 0.0125357  0.05122557 0.0543588  0.02082193
 0.02871055 0.02697433 0.02817602 0.02185594 0.03202711 0.02092233
 0.00619899 0.04123321 0.02817602 0.01380463 0.00619899 0.00619899
 0.00619899]
[0.02274967 0.01945669 0.0169512  0.03354684 0.03848886 0.04982267
 0.04121035 0.02566582 0.03205901 0.0397759  0.02128272 0.03205901
 0.01150839 0.03495317 0.01950353 0.01202463 0.041433   0.03205901
 0.01033411 0.04236311 0.01873473 0.04521413 0.0397759  0.02094497
 0.02538366 0.02134198 0.03205901 0.02440098 0.03495317 0.01950353
 0.01202463 0.041433   0.03205901 0.01884974 0.01202462 0.01202462
 0.01202463]
[0.01435959 0.01197058 0.02151628 0.02701731 0.03626199 0.0326155
 0.06107522 0.02354896 0.02766074 0.05870202 0.01799474 0.02766074
 0.00664452 0.04665343 0.02347189 0.0055199  0.04369224 0.02766074
 0.00780201 0.05988816 0.01386981 0.04855224 0.05870202 0.02143618
 0.0280388  0.02371353 0.02766074 0.02039652 0.04665343 0.02347189
 0.0055199  0.04369224 0.02766075 0.01235568 0.00551991 0.00551991
 0.0055199 ]
[0.01539819 0.01352388 0.01593301 0.02904391 0.03422067 0.03939955
 0.06542805 0.03004807 0.03191891 0.05774611 0.02635376 0.03191891
 0.00824604 0.0381464  0.02186537 0.00723767 0.04074437 0.03191891
 0.00796814 0.04813288 0.01309257 0.0362916  0.05774611 0.02434302
 0.02603322 0.01794729 0.03191891 0.02234878 0.0381464  0.02186537
 0.00723767 0.04074437 0.03191891 0.01346003 0.00723767 0.00723767
 0.00723767]
[0.01539819 0.01352388 0.01593301 0.02904391 0.03422067 0.03939955
 0.06542805 0.03004807 0.03191891 0.05774611 0.02635376 0.03191891
 0.00824604 0.0381464  0.02186537 0.00723767 0.04074437 0.03191891
 0.00796814 0.04813288 0.01309257 0.0362916  0.05774611 0.02434302
 0.02603322 0.01794729 0.03191891 0.02234878 0.0381464  0.02186537
 0.00723767 0.04074437 0.03191891 0.01346003 0.00723767 0.00723767
 0.00723767]
[0.01539819 0.01352388 0.01593301 0.02904391 0.03422067 0.03939955
 0.06542804 0.03004807 0.03191891 0.0577461  0.02635377 0.03191891
 0.00824604 0.03814638 0.02186537 0.00723767 0.04074437 0.03191891
 0.00796814 0.04813289 0.01309257 0.03629158 0.0577461  0.02434302
 0.02603322 0.01794729 0.03191891 0.02234878 0.03814638 0.02186537
 0.00723767 0.04074437 0.03191891 0.01346003 0.00723767 0.00723767
 0.00723767]]