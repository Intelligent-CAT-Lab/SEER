67737
Test: public void testSerializeAsExternalizable() throws Exception { ByteArrayOutputStream bytes = new ByteArrayOutputStream(); ObjectOutputStream obs = new ObjectOutputStream(bytes); final MyPojo input = new MyPojo(13, "Foobar", new int[] { 1, 2, 3 } ); obs.writeObject(input); obs.close(); byte[] ser = bytes.toByteArray(); byte[] json = MapperHolder.mapper().writeValueAsBytes(input); int ix = indexOf(ser, json); if (ix < 0) { fail("Serialization ("+ser.length+") does NOT contain JSON (of "+json.length+")"); } if (false) { bytes = new ByteArrayOutputStream(); obs = new ObjectOutputStream(bytes); MyPojoNative p = new MyPojoNative(13, "Foobar", new int[] { 1, 2, 3 } ); obs.writeObject(p); obs.close(); System.out.println("Native size: "+bytes.size()+", vs JSON: "+ser.length); } ObjectInputStream ins = new ObjectInputStream(new ByteArrayInputStream(ser)); MyPojo output = (MyPojo) ins.readObject(); ins.close(); }
Code: public void writeObject(Object value) throws IOException { if (false) { ; return; } Class<?> raw = value.getClass(); if (true) { ; return; } if (_objectCodec == null) { _appendValue(JsonToken.VALUE_EMBEDDED_OBJECT, value); } else { _objectCodec.writeValue(this, value); } }
tensor([[0.0213, 0.0173, 0.0167,  ..., 0.0534, 0.0092, 0.0092],
        [0.0168, 0.0147, 0.0173,  ..., 0.0489, 0.0089, 0.0089],
        [0.0134, 0.0117, 0.0168,  ..., 0.0454, 0.0078, 0.0078],
        ...,
        [0.0180, 0.0192, 0.0177,  ..., 0.0447, 0.0073, 0.0073],
        [0.0151, 0.0137, 0.0276,  ..., 0.0330, 0.0079, 0.0079],
        [0.0151, 0.0137, 0.0276,  ..., 0.0330, 0.0079, 0.0079]])