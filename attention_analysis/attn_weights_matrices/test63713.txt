63713
Test: public void testOffsetWithObjectFieldsUsingUTF8() throws Exception { final JsonFactory f = new JsonFactory(); byte[] b = "{\"f1\":\"v1\",\"f2\":{\"f3\":\"v3\"},\"f4\":[true,false],\"f5\":5}".getBytes("UTF-8"); JsonParser p = f.createParser(b); p.close(); }
Code: public boolean nextFieldName(SerializableString sstr) throws IOException { _numTypesValid = NR_UNKNOWN; if (_currToken == JsonToken.FIELD_NAME) { _nextAfterName(); return false; } if (_tokenIncomplete) { _skipString(); } int i = _skipWSOrEnd(); if (i < 0) { close(); _currToken = null; return false; } _binaryValue = null; if (i == INT_RBRACKET) { _updateLocation(); if (!_parsingContext.inArray()) { _reportMismatchedEndMarker(i, '}'); } _parsingContext = _parsingContext.getParent(); _currToken = JsonToken.END_ARRAY; return false; } if (i == INT_RCURLY) { _updateLocation(); if (!_parsingContext.inObject()) { _reportMismatchedEndMarker(i, ']'); } _parsingContext = _parsingContext.getParent(); _currToken = JsonToken.END_OBJECT; return false; } if (_parsingContext.expectComma()) { i = _skipComma(i); } if (!_parsingContext.inObject()) { _updateLocation(); _nextTokenNotInObject(i); return false; } _updateNameLocation(); if (i == INT_QUOTE) { char[] nameChars = sstr.asQuotedChars(); final int len = nameChars.length; if ((_inputPtr + len + 4) < _inputEnd) { final int end = _inputPtr+len; if (_inputBuffer[end] == '"') { int offset = 0; int ptr = _inputPtr; while (true) { if (ptr == end) { _parsingContext.setCurrentName(sstr.getValue()); _isNextTokenNameYes(_skipColonFast(ptr+1)); return true; } if (nameChars[offset] != _inputBuffer[ptr]) { break; } ++offset; ++ptr; } } } } return _isNextTokenNameMaybe(i, sstr.getValue()); }
tensor([[0.0047, 0.0120, 0.0020,  ..., 0.0104, 0.0043, 0.0020],
        [0.0037, 0.0225, 0.0013,  ..., 0.0138, 0.0044, 0.0014],
        [0.0034, 0.0181, 0.0018,  ..., 0.0073, 0.0055, 0.0016],
        ...,
        [0.0052, 0.0151, 0.0016,  ..., 0.0107, 0.0044, 0.0019],
        [0.0035, 0.0157, 0.0018,  ..., 0.0110, 0.0044, 0.0012],
        [0.0034, 0.0126, 0.0019,  ..., 0.0076, 0.0062, 0.0017]])