66863
Test: public void testIssue744() throws IOException { ObjectMapper mapper = new ObjectMapper(); SimpleModule module = new SimpleModule(); module.addDeserializer(DataA.class, new DataADeserializer()); mapper.registerModule(module); DataB db = new DataB(); db.da.i = 11; db.k = 13; String jsonBString = mapper.writeValueAsString(db); JsonNode jsonBNode = mapper.valueToTree(db); DataB dbNewViaString = mapper.readValue(jsonBString, DataB.class); DataB dbNewViaNode = mapper.treeToValue(jsonBNode, DataB.class); DataB dbUpdViaString = new DataB(); DataB dbUpdViaNode = new DataB(); mapper.readerForUpdating(dbUpdViaString).readValue(jsonBString); mapper.readerForUpdating(dbUpdViaNode).readValue(jsonBNode); }
Code: public <T extends JsonNode> T valueToTree(Object fromValue) throws IllegalArgumentException { if (fromValue == null) return null; TokenBuffer buf = new TokenBuffer(this, false); JsonNode result; try { writeValue(buf, fromValue); JsonParser jp = buf.asParser(); result = readTree(jp); jp.close(); } catch (IOException e) { throw new IllegalArgumentException(e.getMessage(), e); } return (T) result; }
tensor([[0.0148, 0.0128, 0.0117,  ..., 0.0151, 0.0255, 0.0069],
        [0.0109, 0.0144, 0.0125,  ..., 0.0126, 0.0291, 0.0045],
        [0.0146, 0.0116, 0.0117,  ..., 0.0154, 0.0256, 0.0078],
        ...,
        [0.0150, 0.0125, 0.0133,  ..., 0.0142, 0.0273, 0.0067],
        [0.0134, 0.0130, 0.0150,  ..., 0.0165, 0.0270, 0.0056],
        [0.0105, 0.0142, 0.0130,  ..., 0.0164, 0.0206, 0.0060]])