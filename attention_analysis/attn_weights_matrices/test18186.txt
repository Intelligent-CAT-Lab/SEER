18186
Test: public void testRecordTypeSubtyping() { RecordTypeBuilder builder = new RecordTypeBuilder(registry); builder.addProperty("a", NUMBER_TYPE, null); builder.addProperty("b", STRING_TYPE, null); builder.addProperty("c", STRING_TYPE, null); JSType subRecordType = builder.build(); builder = new RecordTypeBuilder(registry); builder.addProperty("a", OBJECT_TYPE, null); builder.addProperty("b", STRING_TYPE, null); JSType differentRecordType = builder.build(); }
Code: static boolean isSubtype(ObjectType typeA, RecordType typeB){for (String property : typeB.properties.keySet()) {if (!typeA.hasProperty(property)) {return false;}JSType propA = typeA.getPropertyType(property);JSType propB = typeB.getPropertyType(property);if (!propA.isUnknownType() && !propB.isUnknownType()) {if (typeA.isPropertyTypeDeclared(property)) {if (!propA.isInvariant(propB)) {return true;}} else {if (!propA.isSubtype(propB)) {return false;}}}}return true;}
[[0.04866192 0.06878943 0.01780913 0.06916868 0.02230177 0.01149424
 0.01222923 0.0638257  0.01567393 0.02518768 0.01594168 0.02291051
 0.05339355 0.04373451 0.05530879 0.01332398 0.01904696 0.0118376
 0.01332398 0.01725966 0.00586901 0.01397759 0.02457553 0.01594168
 0.02787724 0.01594168 0.02636804 0.05339355 0.04543398 0.03075886
 0.01594168 0.01873557 0.05339354 0.01395623 0.01661289]
[0.04362426 0.07971907 0.01341729 0.08119746 0.0177627  0.01121067
 0.0078445  0.08481053 0.00881595 0.02272975 0.01101659 0.01984366
 0.05035928 0.04792077 0.09005584 0.01031441 0.02025827 0.01222822
 0.01031441 0.01571702 0.00282326 0.00838445 0.01808779 0.01101659
 0.02964715 0.01101659 0.02402175 0.05035928 0.04978906 0.03327881
 0.01101659 0.01430034 0.05035926 0.01017944 0.01655903]
[0.05039969 0.06136198 0.01285946 0.07362933 0.01664133 0.00824621
 0.00685361 0.08938698 0.00761496 0.02788633 0.01055369 0.02034729
 0.05314164 0.06572685 0.09644162 0.00798395 0.02092297 0.00894563
 0.00798395 0.01284402 0.00259911 0.00707278 0.02018204 0.01055369
 0.02842234 0.01055369 0.02228255 0.05314164 0.05783344 0.02443969
 0.01055369 0.01536364 0.05314165 0.00681635 0.01727225]
[0.04897098 0.06387349 0.0194809  0.06354037 0.02048893 0.0118614
 0.01046038 0.07910305 0.01076347 0.03025638 0.01469821 0.02315268
 0.05134041 0.04527064 0.06611974 0.01082768 0.02015944 0.01025773
 0.01082768 0.01874466 0.0037559  0.01150443 0.02652619 0.01469821
 0.0320484  0.01469821 0.0243843  0.05134041 0.04005009 0.03443885
 0.01469821 0.01687101 0.05134041 0.01219373 0.02125343]
[0.05286286 0.06371738 0.01804176 0.06733757 0.02242797 0.01136688
 0.01084699 0.05748823 0.01266424 0.02661062 0.01971415 0.02151874
 0.04597697 0.0512745  0.04887171 0.01153907 0.02484678 0.00852025
 0.01153907 0.01595792 0.00632784 0.01669514 0.02768827 0.01971415
 0.03365198 0.01971415 0.0301128  0.04597697 0.04061642 0.0359682
 0.01971415 0.02196609 0.04597697 0.01300899 0.01974416]
[0.04921063 0.06144984 0.01723463 0.05932484 0.01833611 0.01095758
 0.01012402 0.0601926  0.01616459 0.02610017 0.01607505 0.01664012
 0.04997655 0.04982214 0.0817237  0.01248557 0.02218691 0.01063785
 0.01248557 0.01393489 0.00509712 0.01082477 0.02377394 0.01607505
 0.02733854 0.01607505 0.03819197 0.04997655 0.04273251 0.03545738
 0.01607505 0.02348817 0.04997655 0.01106969 0.01878435]
[0.04710929 0.07162552 0.01508709 0.06583958 0.01776522 0.01271428
 0.00897927 0.06161788 0.01018109 0.02627306 0.01519735 0.01819451
 0.04659314 0.06359424 0.083063   0.01048354 0.02799925 0.00861027
 0.01048354 0.01380509 0.00469503 0.00931515 0.01982733 0.01519735
 0.03005569 0.01519735 0.02851499 0.04659314 0.0508973  0.02945246
 0.01519735 0.01768593 0.04659312 0.01039647 0.02516508]
[0.03923696 0.05887808 0.01680763 0.06307834 0.01892794 0.0117659
 0.01215202 0.0619644  0.01505322 0.02472005 0.01683962 0.01847478
 0.05068048 0.06028996 0.07050936 0.01146299 0.02098382 0.01060733
 0.01146299 0.01670509 0.00503462 0.01064667 0.02459655 0.01683962
 0.03199191 0.01683962 0.0322374  0.05068048 0.04375828 0.03581267
 0.01683962 0.02087048 0.05068048 0.0120691  0.02050152]
[0.04943341 0.05356371 0.01744059 0.0592375  0.0190106  0.0154479
 0.01128996 0.07124174 0.01246441 0.02955476 0.02141873 0.02799448
 0.03657395 0.05402119 0.06210704 0.01428618 0.0215327  0.0123711
 0.01428618 0.01894719 0.00681428 0.01622207 0.02324854 0.02141873
 0.02383102 0.02141873 0.0275608  0.03657395 0.04961322 0.02820779
 0.02141873 0.02304149 0.03657395 0.01363455 0.02819886]
[0.05085381 0.06312147 0.02057839 0.05909737 0.02192112 0.01342482
 0.01145205 0.06184287 0.0156127  0.02950998 0.01675909 0.01990046
 0.03724903 0.04623698 0.07740482 0.0147664  0.02325309 0.01165345
 0.0147664  0.01714146 0.00746789 0.01438987 0.02624103 0.01675909
 0.03010015 0.01675909 0.03147804 0.03724903 0.0489669  0.03535737
 0.01675909 0.02178106 0.03724905 0.01510721 0.01778932]
[0.05036205 0.04808901 0.01480464 0.07049375 0.01766117 0.01096403
 0.0100634  0.05985063 0.01187113 0.03491975 0.01252826 0.01995375
 0.04515992 0.05585105 0.10173483 0.01099625 0.02188644 0.01168453
 0.01099625 0.01822487 0.00375231 0.00879297 0.02602646 0.01252826
 0.02802191 0.01252826 0.03001675 0.04515992 0.05792787 0.02728335
 0.01252826 0.02062094 0.04515993 0.00861121 0.02294591]
[0.04455071 0.07064548 0.01778518 0.06576873 0.01931453 0.01241875
 0.0104968  0.07208417 0.01174699 0.03324053 0.01379002 0.02030754
 0.0485342  0.04663531 0.07800554 0.01186568 0.02162418 0.01129202
 0.01186568 0.02033634 0.00413912 0.00907176 0.02646269 0.01379002
 0.03228483 0.01379002 0.02295031 0.0485342  0.041188   0.03112961
 0.01379002 0.02312466 0.04853418 0.01033497 0.01856717]
[0.04756651 0.05164142 0.01758147 0.0702998  0.02066992 0.01332627
 0.00794449 0.07975961 0.01217837 0.02914001 0.0133887  0.02537294
 0.04743106 0.04930149 0.08096125 0.01202464 0.01813929 0.01233174
 0.01202464 0.01495827 0.00463977 0.00992651 0.02839431 0.0133887
 0.03324315 0.0133887  0.02700814 0.04743106 0.04815341 0.03253381
 0.0133887  0.01708497 0.04743104 0.01136102 0.01658482]
[0.05258229 0.05599429 0.01668224 0.07193591 0.01679427 0.01005069
 0.00728708 0.09249135 0.01213551 0.0271188  0.01432932 0.02541666
 0.04722589 0.05646165 0.0759699  0.01157965 0.0193562  0.01015597
 0.01157965 0.01634723 0.00370447 0.00978238 0.02140558 0.01432932
 0.03218038 0.01432932 0.02430671 0.04722589 0.04239894 0.02575384
 0.01432932 0.02162554 0.04722587 0.00944794 0.02045996]
[0.03877037 0.07705925 0.01275902 0.08092406 0.0211004  0.01221048
 0.00759658 0.0690641  0.010372   0.02887064 0.01465299 0.01985014
 0.05024467 0.05592616 0.07845626 0.00829642 0.02151849 0.0091323
 0.00829642 0.01514082 0.00370375 0.00822835 0.02017697 0.01465299
 0.02710923 0.01465299 0.02702198 0.05024467 0.04974506 0.0295623
 0.01465299 0.01934116 0.05024469 0.00955692 0.02086431]
[0.05060139 0.05204105 0.02786246 0.05480185 0.02590638 0.0169536
 0.01795102 0.0578161  0.01865489 0.02550326 0.02239799 0.02326686
 0.03866269 0.03465049 0.04254691 0.0183512  0.02762354 0.01510648
 0.0183512  0.01875185 0.00864322 0.01911351 0.02451131 0.02239799
 0.03840574 0.02239799 0.03373182 0.03866269 0.04029102 0.03049408
 0.02239799 0.02111334 0.03866271 0.01429505 0.01708035]
[0.05299766 0.05259655 0.02149521 0.04903112 0.01985126 0.01564746
 0.00993255 0.07402248 0.01456491 0.0322878  0.01636107 0.02428438
 0.04748704 0.05391385 0.0602834  0.01490301 0.01882974 0.01602127
 0.01490301 0.01659391 0.00582811 0.01370644 0.02874544 0.01636107
 0.03052572 0.01636107 0.02579474 0.04748704 0.04449327 0.02996445
 0.01636107 0.01975115 0.04748705 0.0112958  0.01982989]
[0.04187001 0.07881657 0.01253093 0.0723628  0.02056386 0.00980252
 0.00895382 0.08335955 0.00883663 0.02543884 0.01140831 0.01575023
 0.05591287 0.03616881 0.10149526 0.01087748 0.02318608 0.01160443
 0.01087748 0.01520315 0.00318367 0.00878226 0.02182729 0.01140831
 0.02726574 0.01140831 0.02403397 0.05591287 0.03402036 0.03290151
 0.01140831 0.02278013 0.05591283 0.00956793 0.01456682]
[0.05060139 0.05204105 0.02786246 0.05480185 0.02590638 0.0169536
 0.01795102 0.0578161  0.01865489 0.02550326 0.02239799 0.02326686
 0.03866269 0.03465049 0.04254691 0.0183512  0.02762354 0.01510648
 0.0183512  0.01875185 0.00864322 0.01911351 0.02451131 0.02239799
 0.03840574 0.02239799 0.03373182 0.03866269 0.04029102 0.03049408
 0.02239799 0.02111334 0.03866271 0.01429505 0.01708035]
[0.04966727 0.05377717 0.01962979 0.07040743 0.01847561 0.01088053
 0.00947718 0.07805369 0.01479912 0.0282258  0.01540302 0.02334794
 0.03988174 0.05672375 0.07121849 0.01329646 0.02063386 0.01273596
 0.01329646 0.01757394 0.00480689 0.01279743 0.02362925 0.01540302
 0.03270337 0.01540302 0.02453647 0.03988174 0.05168776 0.03316768
 0.01540302 0.02100954 0.03988174 0.01277775 0.01940614]
[0.05958403 0.06333045 0.01528739 0.06753871 0.01648251 0.01124385
 0.00603499 0.07205789 0.01153955 0.03151944 0.01309054 0.02235845
 0.04002877 0.0611402  0.0931331  0.01108705 0.01922564 0.01045038
 0.01108705 0.01616456 0.00381346 0.00819663 0.02908173 0.01309054
 0.0288641  0.01309054 0.02892952 0.04002877 0.05138578 0.0255182
 0.01309054 0.02099705 0.04002875 0.01056491 0.02093493]
[0.0483372  0.07210521 0.01533113 0.07581756 0.01946494 0.01177326
 0.00990552 0.06831007 0.01361018 0.0233917  0.01417723 0.01621399
 0.04403433 0.05965097 0.08129184 0.01157964 0.01902571 0.00946649
 0.01157964 0.01464988 0.00436475 0.00896548 0.02522179 0.01417723
 0.02861842 0.01417723 0.03150571 0.04403433 0.05585276 0.0287512
 0.01417723 0.01754474 0.04403435 0.01076861 0.01808964]
[0.04147634 0.05510917 0.01421138 0.06443024 0.01714501 0.01022518
 0.00916761 0.07246841 0.01309657 0.0288883  0.01578987 0.02638432
 0.04199218 0.05882735 0.08415476 0.0122256  0.02001912 0.01128227
 0.0122256  0.01606568 0.00442628 0.01101799 0.02707982 0.01578987
 0.02842254 0.01578987 0.02689593 0.04199218 0.04956992 0.04059936
 0.01578987 0.02004518 0.04199217 0.01363147 0.0217726 ]
[0.05036205 0.04808901 0.01480464 0.07049375 0.01766117 0.01096403
 0.0100634  0.05985063 0.01187113 0.03491975 0.01252826 0.01995375
 0.04515992 0.05585105 0.10173483 0.01099625 0.02188644 0.01168453
 0.01099625 0.01822487 0.00375231 0.00879297 0.02602646 0.01252826
 0.02802191 0.01252826 0.03001675 0.04515992 0.05792787 0.02728335
 0.01252826 0.02062094 0.04515993 0.00861121 0.02294591]
[0.04599435 0.05995908 0.02450076 0.06423141 0.02315016 0.01537088
 0.01347984 0.06352197 0.01808362 0.0208991  0.02140527 0.02410825
 0.03500587 0.04638522 0.07432832 0.01334147 0.02204578 0.01106978
 0.01334147 0.01929257 0.00538784 0.01592813 0.01993705 0.02140527
 0.02866028 0.02140527 0.03111827 0.03500587 0.04385771 0.03857996
 0.02140527 0.02108179 0.03500586 0.01127254 0.02043372]
[0.05036205 0.04808901 0.01480464 0.07049375 0.01766117 0.01096403
 0.0100634  0.05985063 0.01187113 0.03491975 0.01252826 0.01995375
 0.04515992 0.05585105 0.10173483 0.01099625 0.02188644 0.01168453
 0.01099625 0.01822487 0.00375231 0.00879297 0.02602646 0.01252826
 0.02802191 0.01252826 0.03001675 0.04515992 0.05792787 0.02728335
 0.01252826 0.02062094 0.04515993 0.00861121 0.02294591]
[0.04584557 0.06722577 0.01486479 0.07059921 0.01740112 0.01124455
 0.01010341 0.06443366 0.01577555 0.02462974 0.0134254  0.0214567
 0.05306938 0.05028128 0.08029708 0.01076402 0.01803183 0.01068497
 0.01076402 0.01655369 0.00473581 0.0119866  0.02535372 0.0134254
 0.03196155 0.0134254  0.02970891 0.05306938 0.04170299 0.03128325
 0.0134254  0.01906677 0.05306935 0.01111963 0.01921429]
[0.04756651 0.05164142 0.01758147 0.0702998  0.02066992 0.01332627
 0.00794449 0.07975961 0.01217837 0.02914001 0.0133887  0.02537294
 0.04743106 0.04930149 0.08096125 0.01202464 0.01813929 0.01233174
 0.01202464 0.01495827 0.00463977 0.00992651 0.02839431 0.0133887
 0.03324315 0.0133887  0.02700814 0.04743106 0.04815341 0.03253381
 0.0133887  0.01708497 0.04743104 0.01136102 0.01658482]
[0.04532436 0.05993536 0.01625788 0.07303947 0.02377119 0.01045524
 0.01038562 0.06667428 0.01070255 0.02897183 0.01481209 0.02278117
 0.04352786 0.05377425 0.08103299 0.01136588 0.01994983 0.01083675
 0.01136588 0.01680364 0.00374113 0.00892903 0.02239889 0.01481209
 0.03888017 0.01481209 0.02863912 0.04352786 0.04761082 0.03500709
 0.01481209 0.01923493 0.04352788 0.01234456 0.01995413]
[0.04445972 0.063293   0.01672778 0.07422557 0.01966103 0.01536215
 0.00847633 0.07439745 0.01144022 0.0297229  0.0137894  0.02612123
 0.03731666 0.06002621 0.09002903 0.01054549 0.01907419 0.01290813
 0.01054549 0.01544561 0.00388156 0.00914638 0.02413173 0.0137894
 0.02829092 0.0137894  0.02794536 0.03731666 0.05157921 0.03343362
 0.0137894  0.01701747 0.03731665 0.00910369 0.025901  ]
[0.05036205 0.04808901 0.01480464 0.07049375 0.01766117 0.01096403
 0.0100634  0.05985063 0.01187113 0.03491975 0.01252826 0.01995375
 0.04515992 0.05585105 0.10173483 0.01099625 0.02188644 0.01168453
 0.01099625 0.01822487 0.00375231 0.00879297 0.02602646 0.01252826
 0.02802191 0.01252826 0.03001675 0.04515992 0.05792787 0.02728335
 0.01252826 0.02062094 0.04515993 0.00861121 0.02294591]
[0.04583016 0.06335949 0.01895834 0.06831476 0.02062387 0.01494987
 0.01146317 0.06422284 0.0126612  0.02908846 0.01787668 0.02228652
 0.04895214 0.05014111 0.065644   0.01183469 0.02029811 0.01372262
 0.01183469 0.01624444 0.00478526 0.01350068 0.02225564 0.01787668
 0.02707027 0.01787668 0.02586522 0.04895214 0.04227383 0.03187479
 0.01787668 0.01961436 0.04895214 0.01111552 0.02180303]
[0.0475665  0.05164143 0.01758147 0.07029981 0.02066992 0.01332627
 0.00794449 0.07975964 0.01217837 0.02914001 0.0133887  0.02537294
 0.04743105 0.04930152 0.08096121 0.01202464 0.01813929 0.01233174
 0.01202464 0.01495827 0.00463977 0.00992651 0.02839431 0.0133887
 0.03324316 0.0133887  0.02700814 0.04743105 0.04815341 0.03253381
 0.0133887  0.01708497 0.04743105 0.01136102 0.01658482]
[0.05698924 0.07703611 0.01459846 0.06699304 0.01818023 0.01241878
 0.0066609  0.10099509 0.00787653 0.02869867 0.01104044 0.01898518
 0.04588418 0.05618728 0.08746992 0.00794109 0.02257286 0.0092828
 0.00794109 0.0147399  0.00271322 0.00633783 0.01988658 0.01104044
 0.02769107 0.01104044 0.0270201  0.04588418 0.05000871 0.02675895
 0.01104044 0.01415505 0.04588418 0.00854171 0.01950529]
[0.05468053 0.07307053 0.01765424 0.07612911 0.0267363  0.01052267
 0.01018439 0.04799696 0.01250497 0.03255729 0.01652301 0.02502099
 0.0436561  0.04582839 0.06724095 0.01172257 0.02032362 0.01431981
 0.01172257 0.01875362 0.00437084 0.01051155 0.02531778 0.01652301
 0.03291011 0.01652301 0.02437412 0.0436561  0.05040222 0.0323853
 0.01652301 0.01739277 0.0436561  0.01152701 0.0167784 ]]